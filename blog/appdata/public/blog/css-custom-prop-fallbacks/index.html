<html lang="en">
  <head>
    <meta charset="utf-8"></meta>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"></meta>
    <meta name="generator" content="VueGo"></meta>
    <title>CSS Custom Property Fallbacks in Shorthand Values</title>
    <meta name="description"></meta>
    <link rel="canonical"></link>
    <meta name="author" content="Tit Petric"></meta>
    <link rel="icon" href="/assets/favicon/favicon.ico" sizes="32x32"></link>
    <link rel="icon" href="/assets/favicon/favicon.svg" type="image/svg+xml"></link>
    <link rel="apple-touch-icon" href="/assets/favicon/apple-touch-icon.png"></link>
    <link rel="manifest" href="/assets/site.webmanifest"></link>
    <meta name="twitter:card" content="summary_large_image"></meta>
    <meta name="twitter:title"></meta>
    <meta name="twitter:description"></meta>
    <meta name="twitter:image"></meta>
    <meta name="og:title"></meta>
    <meta name="og:description"></meta>
    <meta property="og:image"></meta>
    <meta name="fediverse:creator" content="@hexagoncircle@fosstodon.org"></meta>
    <link href="https://github.com/hexagoncircle" rel="me"></link>
    <link href="https://twitter.com/hexagoncircle" rel="me"></link>
    <link href="https://fosstodon.org/@hexagoncircle" rel="me"></link>
    <link href="https://codepen.io/hexagoncircle" rel="me"></link>
    <link rel="webmention" href="https://webmention.io/ryanmulligan.dev/webmention"></link>
    <link rel="pingback" href="https://webmention.io/ryanmulligan.dev/xmlrpc"></link>
    <link rel="alternate" type="application/atom+xml" title="Ryan Mulligan"></link>
    <link rel="stylesheet" href="/assets/css/themes.css"></link>
    <link rel="stylesheet" href="/assets/css/styles.css"></link>
    <style></style>
  </head>
  <body>
    <script>
  (function () {
    let root = document.documentElement;
    let body = document.body;

    let appearance = localStorage.getItem("appearance");
    let theme = localStorage.getItem("theme");

    appearance && root.setAttribute("data-appearance", appearance);
    theme && body.setAttribute("data-theme", theme);
  })();
    </script>
    <header class="site-header">
      <nav class="cluster">
        <ul class="cluster" role="list">
          <li class="jump-to-content">
            <a href="#main" class="text-label">Jump to main content</a>
          </li>
          <li>
            <a href="/">Home</a>
          </li>
          <li>
            <a href="/blog/">Blog</a>
          </li>
          <li>
            <a href="/feed.xml">RSS</a>
          </li>
        </ul>
        <theme-machine class="theme-machine">
          <fieldset class="control-appearance">
            <legend class="visually-hidden">Select appearance</legend>
            <input id="appearance-system" type="radio" name="appearance" class="visually-hidden" value="system"></input>
            <label for="appearance-system">
              <span class="visually-hidden">System</span>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="24" height="24" fill="currentcolor"><rect width="256" height="256" fill="none"/><rect x="24" y="40" width="208" height="160" rx="24"/><path d="M160,216H96a8,8,0,0,0,0,16h64a8,8,0,0,0,0-16Z"/></svg>            </label>
            <input id="appearance-light" type="radio" name="appearance" class="visually-hidden" value="light"></input>
            <label for="appearance-light">
              <span class="visually-hidden">Light</span>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="24" height="24" fill="currentcolor"><rect width="256" height="256" fill="none"/><path d="M120,40V16a8,8,0,0,1,16,0V40a8,8,0,0,1-16,0Zm8,24a64,64,0,1,0,64,64A64.07,64.07,0,0,0,128,64ZM58.34,69.66A8,8,0,0,0,69.66,58.34l-16-16A8,8,0,0,0,42.34,53.66Zm0,116.68-16,16a8,8,0,0,0,11.32,11.32l16-16a8,8,0,0,0-11.32-11.32ZM192,72a8,8,0,0,0,5.66-2.34l16-16a8,8,0,0,0-11.32-11.32l-16,16A8,8,0,0,0,192,72Zm5.66,114.34a8,8,0,0,0-11.32,11.32l16,16a8,8,0,0,0,11.32-11.32ZM48,128a8,8,0,0,0-8-8H16a8,8,0,0,0,0,16H40A8,8,0,0,0,48,128Zm80,80a8,8,0,0,0-8,8v24a8,8,0,0,0,16,0V216A8,8,0,0,0,128,208Zm112-88H216a8,8,0,0,0,0,16h24a8,8,0,0,0,0-16Z"/></svg>            </label>
            <input id="appearance-dark" type="radio" name="appearance" class="visually-hidden" value="dark"></input>
            <label for="appearance-dark">
              <span class="visually-hidden">Dark</span>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="24" height="24" fill="currentcolor"><rect width="256" height="256" fill="none"/><path d="M240,96a8,8,0,0,1-8,8H216v16a8,8,0,0,1-16,0V104H184a8,8,0,0,1,0-16h16V72a8,8,0,0,1,16,0V88h16A8,8,0,0,1,240,96ZM144,56h8v8a8,8,0,0,0,16,0V56h8a8,8,0,0,0,0-16h-8V32a8,8,0,0,0-16,0v8h-8a8,8,0,0,0,0,16Zm65.14,94.33A88.07,88.07,0,0,1,105.67,46.86a8,8,0,0,0-10.6-9.06A96,96,0,1,0,218.2,160.93a8,8,0,0,0-9.06-10.6Z"/></svg>            </label>
            <div class="highlighter"></div>
          </fieldset>
          <button class="theme-display-toggle" aria-expanded="false" aria-controls="theme-display">
            <span class="visually-hidden">Select theme</span>
<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"/>
  <path d="M49.67,186.24h0L40.48,207.3a5.74,5.74,0,0,0,1.2,6.36,8,8,0,0,0,8.86,1.67l20-8.74h0a32,32,0,0,0,32.06-8L141.25,160H52.3A32.07,32.07,0,0,0,49.67,186.24Z" fill="var(--color-theme-accent)" />
  <path d="M182.43,113.17l4.88,4.89a16,16,0,0,1,0,22.63l-9,9a8,8,0,0,1-11.31,0L106.34,89a8,8,0,0,1,0-11.31l9-9a16,16,0,0,1,22.63,0l4.89,4.88,25-25.1c10.79-10.79,28.37-11.45,39.44-1a28,28,0,0,1,.57,40.15Z" fill="none" stroke="var(--color-theme)" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
  <path d="M159.31,141.94l-56.68,56.69a32,32,0,0,1-32.06,8h0l-20,8.74a8,8,0,0,1-8.86-1.67h0a5.74,5.74,0,0,1-1.2-6.36l9.19-21.06h0a32,32,0,0,1,7.7-32.87l56.69-56.68" fill="none" stroke="var(--color-theme)" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>
</svg>
          </button>
          <div id="theme-display" class="theme-display-wrapper" hidden="">
            <fieldset class="control-theme">
              <legend class="visually-hidden">Select theme</legend>
              <div class="options">
                <label for="theme-default" data-theme="default">
                  <span class="visually-hidden">default</span>
                  <input id="theme-default" type="radio" name="theme" value="default"></input>
                </label>
                <label for="theme-pink" data-theme="pink">
                  <span class="visually-hidden">pink</span>
                  <input id="theme-pink" type="radio" name="theme" value="pink"></input>
                </label>
                <label for="theme-blue" data-theme="blue">
                  <span class="visually-hidden">blue</span>
                  <input id="theme-blue" type="radio" name="theme" value="blue"></input>
                </label>
                <label for="theme-green" data-theme="green">
                  <span class="visually-hidden">green</span>
                  <input id="theme-green" type="radio" name="theme" value="green"></input>
                </label>
                <label for="theme-purple" data-theme="purple">
                  <span class="visually-hidden">purple</span>
                  <input id="theme-purple" type="radio" name="theme" value="purple"></input>
                </label>
                <label for="theme-slate" data-theme="slate">
                  <span class="visually-hidden">slate</span>
                  <input id="theme-slate" type="radio" name="theme" value="slate"></input>
                </label>
              </div>
            </fieldset>
          </div>
        </theme-machine>
        <script>
  class ThemeMachine extends HTMLElement {
    constructor() {
      super();
      this.themeToggle;
      this.themeDisplay;
    }

    connectedCallback() {
      this.setupControl("appearance", document.documentElement);
      this.setupControl("theme", document.body);

      this.themeToggle = this.querySelector(".theme-display-toggle");
      this.themeDisplay = this.querySelector(".theme-display-wrapper");

      this.handleClickOutside();
      this.themeToggle.addEventListener("click", this.handleThemeToggleClick.bind(this));
    }

    handleChange(e, prop, el) {
      const attr = `data-${prop}`;
      const value = e.target.value;

      if (!value) {
        localStorage.removeItem(prop);
        el.removeAttribute(attr);
        return;
      }

      localStorage.setItem(prop, value);
      el.setAttribute(attr, value);
    }

    handleThemeToggleClick() {
      let expanded = this.themeToggle.getAttribute("aria-expanded") === "true" || false;

      this.themeToggle.setAttribute("aria-expanded", !expanded);
      this.themeDisplay.toggleAttribute("hidden", expanded);
    }

    handleClickOutside() {
      document.addEventListener(
        "click",
        (e) => {
          if (!e.target.closest("theme-machine")) {
            this.themeToggle.setAttribute("aria-expanded", false);
            this.themeDisplay.toggleAttribute("hidden", true);
          }
        },
        false
      );
    }

    setupControl(prop, el) {
      const initialValue = localStorage.getItem(prop) || "";
      const collection = this.querySelectorAll(`[name='${prop}']`);

      for (let item of collection) {
        item.checked = item.value === initialValue;
        item.addEventListener("change", (e) => this.handleChange(e, prop, el));
      }
    }
  }

  if ("customElements" in window) {
    window.customElements.define("theme-machine", ThemeMachine);
  }
</script>
        <style>
.theme-machine {
  --_padding: 0.3em;
  --_radius: var(--radius-pill);
  --icon-size: 1.2em;
  position: relative;
  display: flex;
  isolation: isolate;
  /* Transition theme display */
}
@media (forced-colors: active) {
  .theme-machine {
    forced-color-adjust: none;
  }
}
.theme-machine .control-appearance {
  all: unset;
  position: relative;
  display: flex;
  gap: var(--_padding);
  background: var(--color-theme);
  padding: var(--_padding);
  border-radius: 360px;
  isolation: isolate;
  transform: translateZ ( 0 );
  inline-size: fit-content;
  z-index: 2;
}
.theme-machine .control-appearance label {
  display: grid;
  place-items: center;
  place-content: center;
  border-radius: 50%;
  padding: var(--_padding);
  color: var(--color-theme-offset);
  cursor: pointer;
}
.theme-machine .control-appearance input:checked + label {
  color: currentcolor;
}
.theme-machine .control-appearance input:checked:focus-visible + label {
  outline: var(--focus-outline);
  outline-offset: 2px;
}
.theme-machine .control-appearance .highlighter {
  content: "";
  position: absolute;
  top: var(--_padding);
  left: var(--_padding);
  aspect-ratio: 1;
  height: calc(100% - var(--_padding) * 2);
  background: var(--color-theme-accent);
  border-radius: 50%;
  pointer-events: none;
  z-index: -1;
  transition: translate 250ms cubic-bezier(0.65, 0, 0.35, 1);
}
.theme-machine .control-appearance input:focus-visible ~ .highlighter {
  transition: unset;
}
.theme-machine .theme-display-toggle {
  --_pull: 2rem;
  all: unset;
  position: relative;
  z-index: 1;
  display: grid;
  align-items: center;
  cursor: pointer;
  padding-block: calc(var(--_padding) * 2);
  border-radius: 0 var(--_radius) var(--_radius) 0;
  background-color: var(--color-theme-offset);
  margin-inline-start: calc(var(--_pull) * -1);
  padding-inline: calc(var(--_pull) + var(--_padding)) calc(var(--_padding) + 0.3rem);
}
.theme-machine .theme-display-toggle .icon {
  scale: 1.01;
  border-radius: var(--radius-round);
}
.theme-machine .theme-display-toggle:focus-visible .icon {
  outline: 2px solid var(--color-bg-accent);
  outline-offset: 2px;
}
.theme-machine .theme-display-wrapper {
  position: absolute;
  top: 0;
  right: 0;
  display: grid;
  align-items: start;
  inline-size: calc(100% - var(--_padding));
  block-size: 200%;
  mask-image: linear-gradient(transparent 25%, black 0);
  z-index: 0;
}
.theme-machine .control-theme {
  display: flex;
  gap: var(--space-3xs);
  padding: var(--space-xs);
  block-size: 50%;
  border-radius: var(--_radius);
  background-color: var(--color-theme-offset);
}
.theme-machine .control-theme::before {
  content: "";
  position: absolute;
  bottom: 50%;
  left: 0;
  inline-size: 100%;
  block-size: 100%;
  background-color: inherit;
  z-index: -1;
}
.theme-machine .control-theme .options {
  --_border-color: var(--color-theme-accent);
  display: flex;
  gap: var(--space-3xs);
  justify-content: space-between;
  inline-size: 100%;
}
.theme-machine .control-theme input {
  --_size: 0.95em;
  appearance: none;
  margin: 0;
  font: inherit;
  color: currentColor;
  width: var(--_size);
  height: var(--_size);
  border: 2px solid var(--color-theme);
  border-radius: var(--radius-round);
  background-color: var(--color-theme-offset);
  display: grid;
  place-content: center;
}
.theme-machine .control-theme input::before {
  --_size: 0.5em;
  content: "";
  width: var(--_size);
  height: var(--_size);
  border-radius: var(--radius-round);
  background-color: var(--color-theme);
  scale: 0;
}
.theme-machine .control-theme input:focus-visible {
  outline: 2px solid var(--color-theme-accent);
  outline-offset: 1px;
}
.theme-machine .control-theme input:checked::before {
  scale: 1;
  transition: 200ms scale cubic-bezier(0.34, 1.56, 0.64, 1);
}
.theme-machine .control-theme input:checked {
  background-color: transparent;
}
.theme-machine .theme-display-wrapper {
  --_transition: translate 300ms cubic-bezier(0.16, 1, 0.3, 1);
  translate: var(--_padding) var(--_padding);
  transition: var(--_transition);
}
.theme-machine .control-theme {
  translate: 0 calc(100% - var(--_padding));
  transition: var(--_transition);
}
.theme-machine .theme-display-wrapper[hidden] {
  translate: 0 0;
}
.theme-machine .theme-display-wrapper[hidden] .control-theme {
  translate: 0 0;
}
.theme-machine .theme-display-wrapper[hidden] input {
  display: none;
}
</style>
      </nav>
    </header>
    <style>
.site-header {
  position: relative;
  display: flex;
  justify-content: flex-end;
  padding-inline: var(--page-gutters);
  margin-block: var(--page-gutters) var(--space-xl);
  z-index: 1;
}
@media (max-width: 40rem) {
  .site-header {
    .site-header nav {
      --column-gap: clamp(var(--space-s), 5vw, var(--space-m));
      --row-gap: var(--space-s);
      --justify: space-between;
      inline-size: 100%;
    }
  }
}
.site-header nav {
  position: relative;
}
.site-header a {
  display: grid;
  place-items: center;
  place-content: center;
  color: currentcolor;
  text-decoration: none;
}
.site-header a:hover {
  color: var(--color-theme-offset);
}
.site-header .jump-to-content {
  position: absolute;
  top: -9999px;
  left: 0;
}
.site-header .jump-to-content:focus-within {
  top: 50%;
  translate: 0 -50%;
  z-index: 1;
}
.site-header .jump-to-content a {
  padding: var(--space-2xs) var(--space-s);
  background-color: var(--color-bg);
}
</style>
    <main id="main" class="breakout flow prose"><figure class="page-timer" aria-hidden="true">
  <svg class="timer" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentcolor" viewBox="0 0 256 256">
    <rect width="256" height="256" fill="none"></rect>
    <circle cx="128" cy="128" r="88" fill="var(--color-theme)"></circle>
    <circle cx="128" cy="128" r="88" fill="none" stroke="currentcolor" stroke-miterlimit="10" stroke-width="16"></circle>
    <line class="timer-hand" x1="128" y1="128" x2="167.6" y2="88.4" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
    <line class="timer-switch" x1="104" y1="8" x2="152" y2="8" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
  </svg>
</figure>
<style>
.page-timer {
  display: none;
}
</style>
<h1 class="title | skewer">
  CSS Custom Property Fallbacks in Shorthand Values
</h1>
<section class="info | cluster skewer">
  <div class="cluster pseudo-gradient">
<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentcolor" viewBox="0 0 256 256">
  <rect width="256" height="256" fill="none"></rect>
  <path d="M40,88H216V48a8,8,0,0,0-8-8H48a8,8,0,0,0-8,8Z" fill="var(--color-theme-accent)"></path>
  <rect x="40" y="40" width="176" height="176" rx="8" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></rect>
  <line x1="176" y1="24" x2="176" y2="56" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
  <line x1="80" y1="24" x2="80" y2="56" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
  <line x1="40" y1="88" x2="216" y2="88" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
</svg>    <span>
      Posted on       <strong>2023-07-14 00:00:00 +0000 UTC</strong>
    </span>
  </div>
  <div class="cluster pseudo-gradient">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="var(--color-text-accent)" viewBox="0 0 256 256">
  <rect width="256" height="256" fill="none"></rect>
  <circle cx="128" cy="128" r="88" fill="var(--color-theme)"></circle>
  <circle cx="128" cy="128" r="88" fill="none" stroke="var(--color-text-accent)" stroke-miterlimit="10" stroke-width="16"></circle>
  <line x1="128" y1="128" x2="167.6" y2="88.4" fill="none" stroke="var(--color-text-accent)" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
  <line x1="104" y1="8" x2="152" y2="8" fill="none" stroke="var(--color-text-accent)" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line>
</svg>    <span>
       Takes about       <strong>6 minutes</strong>
       to read     </span>
  </div>
</section>
<p>CSS Custom Properties are incredibly versatile and have become especially useful as customizable props in common layout and component style patterns. Here&rsquo;s an example derived from the <a href="https://smolcss.dev/#smol-css-grid">SmolCSS</a> site:</p>

<pre class="chroma language-css"><code>.<span style="color:#a6e22e">grid</span> {
  --min: <span style="color:#ae81ff">15</span><span style="color:#66d9ef">ch</span>;
  --gap: <span style="color:#ae81ff">1</span><span style="color:#66d9ef">rem</span>;

  <span style="color:#66d9ef">display</span>: <span style="color:#66d9ef">grid</span>;
  <span style="color:#66d9ef">gap</span>: <span style="color:#a6e22e">var</span>(<span style="color:#f92672">-</span><span style="color:#f92672">-</span>gap);
  <span style="color:#66d9ef">grid-template-columns</span>: <span style="color:#a6e22e">repeat</span>(<span style="color:#66d9ef">auto</span><span style="color:#f92672">-</span>fit, <span style="color:#a6e22e">minmax</span>(<span style="color:#a6e22e">min</span>(<span style="color:#ae81ff">100</span><span style="color:#66d9ef">%</span>, <span style="color:#a6e22e">var</span>(<span style="color:#f92672">-</span><span style="color:#f92672">-</span>min)), <span style="color:#ae81ff">1</span>fr));
}
</code></pre>

<p>The <code>--gap</code> and <code>--min</code> custom property values can be customized by declaring new values for those properties, whether it&rsquo;s through inline styles or a custom CSS ruleset:</p>

<pre class="chroma language-html"><code><span style="color:#75715e">&lt;!--</span><span style="color:#75715e"> inline style </span><span style="color:#75715e">--&gt;</span>
&lt;<span style="color:#f92672">ul</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;grid&#34;</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--gap: 2rem&#34;</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;Item 1&lt;/<span style="color:#f92672">li</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;Item 2&lt;/<span style="color:#f92672">li</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;Item 3&lt;/<span style="color:#f92672">li</span>&gt;
&lt;/<span style="color:#f92672">ul</span>&gt;

<span style="color:#75715e">&lt;!--</span><span style="color:#75715e"> custom ruleset </span><span style="color:#75715e">--&gt;</span>
&lt;<span style="color:#f92672">style</span>&gt;
  .<span style="color:#a6e22e">super-cool-list</span> {
    --gap: <span style="color:#ae81ff">2</span><span style="color:#66d9ef">rem</span>;
  }
&lt;/<span style="color:#f92672">style</span>&gt;
&lt;<span style="color:#f92672">ul</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;super-cool-list grid&#34;</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;Item 1&lt;/<span style="color:#f92672">li</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;Item 2&lt;/<span style="color:#f92672">li</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;Item 3&lt;/<span style="color:#f92672">li</span>&gt;
&lt;/<span style="color:#f92672">ul</span>&gt;
</code></pre>

<p>Remember! The <code>super-cool-list</code> styles needs to be declared <em>after</em> the <code>grid</code> ruleset in the stylesheet. Otherwise the default <code>--gap</code> value inside <code>grid</code> would win with higher precedence. I&rsquo;m a fan of using <a href="https://css-tricks.com/css-cascade-layers/">CSS cascade layers</a> where layout primitives like <code>grid</code> would reside in a lower priority layer than component-specific styles.
{.callout}</p>

<p>I absolutely love this concept of altering layouts through exposed props like the example above. But what if we desired the ability to provide independent values for the horizontal and vertical spacing between each item? This is where a key feature of CSS custom properties comes into play: <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties#custom_property_fallback_values">fallback values</a>. In the revised version of the above code snippet, The <code>--gap</code> value declared at the start of the ruleset becomes the fallback—or default value—for two new variables.</p>

<pre class="chroma language-css"><code>.<span style="color:#a6e22e">grid</span> {
  --min: <span style="color:#ae81ff">15</span><span style="color:#66d9ef">ch</span>;
  --gap: <span style="color:#ae81ff">1</span><span style="color:#66d9ef">rem</span>;
  --row-gap: <span style="color:#66d9ef">initial</span>;
  --column-gap: <span style="color:#66d9ef">initial</span>;

  <span style="color:#66d9ef">display</span>: <span style="color:#66d9ef">grid</span>;
  <span style="color:#66d9ef">gap</span>: <span style="color:#a6e22e">var</span>(<span style="color:#f92672">-</span><span style="color:#f92672">-</span><span style="color:#66d9ef">row</span><span style="color:#f92672">-</span>gap, <span style="color:#a6e22e">var</span>(<span style="color:#f92672">-</span><span style="color:#f92672">-</span>gap)) <span style="color:#a6e22e">var</span>(<span style="color:#f92672">-</span><span style="color:#f92672">-</span><span style="color:#66d9ef">column</span><span style="color:#f92672">-</span>gap, <span style="color:#a6e22e">var</span>(<span style="color:#f92672">-</span><span style="color:#f92672">-</span>gap));
  <span style="color:#66d9ef">grid-template-columns</span>: <span style="color:#a6e22e">repeat</span>(<span style="color:#66d9ef">auto</span><span style="color:#f92672">-</span>fit, <span style="color:#a6e22e">minmax</span>(<span style="color:#a6e22e">min</span>(<span style="color:#ae81ff">100</span><span style="color:#66d9ef">%</span>, <span style="color:#a6e22e">var</span>(<span style="color:#f92672">-</span><span style="color:#f92672">-</span>min)), <span style="color:#ae81ff">1</span>fr));
}
</code></pre>

<p>The <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/gap"><code>gap</code> property</a> is shorthand for <code>row-gap</code> and <code>column-gap</code> respectively. With these values now split, we can pass in an override value to either axis.</p>

<pre class="chroma language-html"><code>&lt;<span style="color:#f92672">ul</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;grid&#34;</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--row-gap: 2rem&#34;</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;Item 1&lt;/<span style="color:#f92672">li</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;Item 2&lt;/<span style="color:#f92672">li</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;Item 3&lt;/<span style="color:#f92672">li</span>&gt;
&lt;/<span style="color:#f92672">ul</span>&gt;
</code></pre>

<p>The gap spacing between each row of items will now be <code>2rem</code> while the columns stick to the default <code>--gap</code> size of <code>1rem</code>.</p>

<h2>Guaranteed-invalid values</h2>

<p><code>--row-gap</code> and <code>--column-gap</code> are both set to the <code>initial</code> keyword because it&rsquo;s a <a href="https://drafts.csswg.org/css-variables/#guaranteed-invalid-value">guaranteed-invalid value</a> in custom properties. This means that these two custom property values will become invalid at computed-value time and revert to a fallback if one is available. I think this concept is summed up nicely in <a href="https://css-tricks.com/using-custom-property-stacks-to-tame-the-cascade/">a snippet from this article</a>:</p>

<blockquote>
<p>[&hellip;] rather than being passed along to set <code>background: initial</code> or <code>color: initial</code>, the custom property becomes <code>undefined</code>, and we fallback to the next value in our stack [&hellip;]</p>
</blockquote>

<p>In the example above, since <code>--row-gap</code> and <code>--column-gap</code> are undefined through the <code>initial</code> keyword, the fallback <code>--gap</code> value is applied.</p>

<h2>Why not only use fallbacks?</h2>

<p>Custom properties can have more than one fallback value—a concept Miriam Suzanne refers to as <a href="https://css-tricks.com/using-custom-property-stacks-to-tame-the-cascade/">custom property &ldquo;stacks&rdquo; in this article</a>, which I love. It&rsquo;s also where I discovered how <code>initial</code> works in custom properties as mentioned above.</p>

<p>So then if custom properties can have multiple fallback values, could we instead write our CSS like this?</p>

<pre class="chroma language-css"><code>.<span style="color:#a6e22e">grid</span> {
  <span style="color:#66d9ef">display</span>: <span style="color:#66d9ef">grid</span>;
  <span style="color:#66d9ef">gap</span>: <span style="color:#a6e22e">var</span>(<span style="color:#f92672">-</span><span style="color:#f92672">-</span><span style="color:#66d9ef">row</span><span style="color:#f92672">-</span>gap, <span style="color:#a6e22e">var</span>(<span style="color:#f92672">-</span><span style="color:#f92672">-</span>gap, <span style="color:#ae81ff">1</span><span style="color:#66d9ef">rem</span>)) <span style="color:#a6e22e">var</span>(<span style="color:#f92672">-</span><span style="color:#f92672">-</span><span style="color:#66d9ef">column</span><span style="color:#f92672">-</span>gap, <span style="color:#a6e22e">var</span>(<span style="color:#f92672">-</span><span style="color:#f92672">-</span>gap, <span style="color:#ae81ff">1</span><span style="color:#66d9ef">rem</span>));
  <span style="color:#66d9ef">grid-template-columns</span>: <span style="color:#a6e22e">repeat</span>(<span style="color:#66d9ef">auto</span><span style="color:#f92672">-</span>fit, <span style="color:#a6e22e">minmax</span>(<span style="color:#a6e22e">min</span>(<span style="color:#ae81ff">100</span><span style="color:#66d9ef">%</span>, <span style="color:#a6e22e">var</span>(<span style="color:#f92672">-</span><span style="color:#f92672">-</span>min, <span style="color:#ae81ff">15</span><span style="color:#66d9ef">ch</span>)), <span style="color:#ae81ff">1</span>fr));
}
</code></pre>

<p>This works as one would expect. However, keep in mind that on the occasion there is a nested element that uses the <code>grid</code> selector, that element would inherit the <code>--gap</code> set on the parent.</p>

<pre class="chroma language-html"><code>&lt;<span style="color:#f92672">ul</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;grid&#34;</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--gap: 2rem&#34;</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;Item 1&lt;/<span style="color:#f92672">li</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;Item 2&lt;/<span style="color:#f92672">li</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;
    Item 3
    <span style="color:#75715e">&lt;!--</span><span style="color:#75715e"> This &lt;ul&gt; will also have a 2rem gap </span><span style="color:#75715e">--&gt;</span>
    &lt;<span style="color:#f92672">ul</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;grid&#34;</span>&gt;
      &lt;<span style="color:#f92672">li</span>&gt;Item 1&lt;/<span style="color:#f92672">li</span>&gt;
      &lt;<span style="color:#f92672">li</span>&gt;Item 2&lt;/<span style="color:#f92672">li</span>&gt;
      &lt;<span style="color:#f92672">li</span>&gt;Item 3&lt;/<span style="color:#f92672">li</span>&gt;
    &lt;/<span style="color:#f92672">ul</span>&gt;
  &lt;/<span style="color:#f92672">li</span>&gt;
&lt;/<span style="color:#f92672">ul</span>&gt;
</code></pre>

<p>By setting <code>--gap</code> at the top of the <code>grid</code> ruleset, the nested element&rsquo;s gap value will reset to that declared default. I personally prefer this. I can imagine headaches may come from having a very deeply (hopefully not too deep!) nested element where the gap value is different than the presumed default. It wouldn&rsquo;t be immediately clear, especially in a componentized codebase.</p>

<h2>Inheritance is a good thing</h2>

<p><strong>This content has been revised on July 15th</strong> after a valid argument was made on <a href="https://fosstodon.org/@hexagoncircle/110713633805281051">my Mastodon post sharing the article</a> in favor of inheriting ancestor custom property values:</p>

<blockquote>
<p>Isn’t inheritance of custom properties a good thing? I thought that’s how they’re meant to be used. Setting a custom property <em>once</em> on an outer container, and then it inherits to <em>all</em> the nested components. I’m not sure that intentionally breaking this system is a good idea.</p>
</blockquote>

<p>Excellent point, and agreed: Inheritance of custom properties is a good thing. This has certainly given me some pause on my preferred approach. I had imagined layout primitives such as the <code>grid</code> example would set ideal default values every time the selector is applied. Instead, when inheriting properties on a nested element, we would then have to add a &ldquo;reset&rdquo; value to revert it back, which arguably may be the optimal method.</p>

<pre class="chroma language-html"><code>&lt;<span style="color:#f92672">ul</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;grid&#34;</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--gap: 2rem&#34;</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;Item 1&lt;/<span style="color:#f92672">li</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;Item 2&lt;/<span style="color:#f92672">li</span>&gt;
  &lt;<span style="color:#f92672">li</span>&gt;
    Item 3
    <span style="color:#75715e">&lt;!--</span><span style="color:#75715e"> Revert the value on this element </span><span style="color:#75715e">--&gt;</span>
    &lt;<span style="color:#f92672">ul</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;grid&#34;</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--gap: 1rem&#34;</span>&gt;
      &lt;<span style="color:#f92672">li</span>&gt;Item 1&lt;/<span style="color:#f92672">li</span>&gt;
      &lt;<span style="color:#f92672">li</span>&gt;Item 2&lt;/<span style="color:#f92672">li</span>&gt;
      &lt;<span style="color:#f92672">li</span>&gt;Item 3&lt;/<span style="color:#f92672">li</span>&gt;
    &lt;/<span style="color:#f92672">ul</span>&gt;
  &lt;/<span style="color:#f92672">li</span>&gt;
&lt;/<span style="color:#f92672">ul</span>&gt;
</code></pre>

<p>What do you think? Please feel free to join us on <a href="https://fosstodon.org/@hexagoncircle/110713633805281051">the Mastodon thread</a> with your opinions and feedback. Also, <a href="https://codepen.io/hexagoncircle/pen/ExOEjGG">check out this CodePen</a> if you&rsquo;d like to experiment with the different methods described here.</p>

<h2>Helpful resources</h2>

<ul>
<li><a href="https://every-layout.dev/">Every Layout</a> has been a key staple in my layout style diet and I highly recommend going through all of it if you haven&rsquo;t already.</li>
<li><a href="https://smolcss.dev/">SmolCSS</a> is a fantastic, robust collection of modern layout and component snippets. A must-bookmark for many revisits.</li>
<li><a href="https://css-tricks.com/using-custom-property-stacks-to-tame-the-cascade/">Using Custom Property “Stacks” to Tame the Cascade</a>—a special thanks to Miriam&rsquo;s article for introducing me to some amazing, new (to me) custom property concepts.</li>
</ul>
<p class="cta arrow-start" style="--flow-space: var(--space-l)">
  <a href="/blog/">Back to all blog posts</a>
</p>
<style>
  :is(.post-timer, .title) {
    --flow-space: 0;
    grid-row: 2;
  }

  .title {
    margin-block-end: 8vh;
  }

  .info {
    order: -1;
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem 1.5rem;
    margin-inline-start: 0.5rem;
    margin-block: 0 1em;
  }

  .info > * {
    align-items: center;
    display: flex;
    gap: 0.2rem;
    line-height: 1.2;
    font-size: 0.8em;
    padding: 0.1rem var(--space-2xs) 0.1rem 0;
  }

  .info svg {
    --_size: 1.75em;
    flex-shrink: 0;
    margin-inline-start: calc(var(--_size) / -2);
    width: var(--_size);
    height: var(--_size);
  }
</style></main>
    <footer class="breakout site-footer">
      <p class="copyright">
        
    ©         <strong>Ryan Mulligan</strong>
         from day one to this magic moment in
            <span></span>
      </p>
      <p>
        
    Assembled with a boundless affinity for the web
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentcolor" viewBox="0 0 256 256">
  <path d="M240,94c0,70-103.79,126.66-108.21,129a8,8,0,0,1-7.58,0C119.79,220.66,16,164,16,94A62.07,62.07,0,0,1,78,32c20.65,0,38.73,8.88,50,23.89C139.27,40.88,157.35,32,178,32A62.07,62.07,0,0,1,240,94Z"></path>
</svg>      </p>
      <ul class="cluster" style="--gap: var(--space-2xs)" role="list">
        <li>
          <a href="/">Home</a>
        </li>
        <li>
          <a href="/blog/">Blog</a>
        </li>
        <li>
          <a href="/feed.xml">RSS</a>
        </li>
        <li>
          <a href="/blogroll/">Blogroll</a>
        </li>
        <li>
          <a href="https://github.com/hexagoncircle/ryan-mulligan-dev/issues/new" target="_blank">Report an issue</a>
        </li>
      </ul>
    </footer>
    <style>
.site-footer {
  position: sticky;
  top: 100vh;
  padding-block: var(--space-2xl);
  font-size: 0.75em;
}
.site-footer p {
  text-wrap: balance;
}
.site-footer .copyright {
  margin-inline-start: -0.1em;
}
.site-footer .icon {
  --_size: 1.2em;
  position: relative;
  top: 0.2em;
  margin-inline: 0.1em;
  width: var(--_size);
  height: var(--_size);
  color: red;
}
.site-footer li {
  display: flex;
  align-items: center;
  gap: 0.2em;
}
</style>
    <script></script>
    <script async="" defer="" src="https://scripts.withcabin.com/hello.js"></script>
  </body>
</html>
